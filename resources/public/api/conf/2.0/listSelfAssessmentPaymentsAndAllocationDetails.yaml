get:
  summary: "List Self Assessment Payments & Allocation Details"

  description: |
    This endpoint enables you to list the payments and allocation details of one or more liabilities for a National insurance number.
    
    ### Test data
    <p>Scenario simulations using Gov-Test-Scenario headers is only available in the sandbox environment.</p>
    <table>
        <thead>
            <tr>
                <th>Header Value (Gov-Test-Scenario)</th>
                <th>Scenario</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><p>N/A - DEFAULT</p></td>
                <td><p>Simulate a successful response.</p></td>
            </tr>
            <tr>
                <td><p>NOT_FOUND</p></td>
                <td><p>Simulates the scenario where no data can be found.</p></td>
            </tr>
        </tbody>
    </table>

  security:
    - User-Restricted:
        - read:self-assessment

  tags:
    - Payments and Liabilities

  parameters:
    - $ref: "./common/headers.yaml#/components/parameters/acceptJson"
    - $ref: "./common/headers.yaml#/components/parameters/contentTypeJson"
    - $ref: "./common/headers.yaml#/components/parameters/testScenarioHeader"
    - $ref: "./common/queryParameters.yaml#/components/parameters/fromDate"
    - $ref: "./common/queryParameters.yaml#/components/parameters/toDate"
    - $ref: "./common/queryParameters.yaml#/components/parameters/paymentLot"
    - $ref: "./common/queryParameters.yaml#/components/parameters/paymentLotItem"

  responses:
    200:
      description: Success
      content:
        application/json:
          schema:
            $ref: "schemas/list_self_assessment_payments_and_allocation_details_schema.json"
          examples:
            Request:
              value:
                $ref: "examples/listSelfAssessmentPaymentsAndAllocationDetails/listSelfAssessmentPaymentsAndAllocationDetails.json"

      headers:
        X-CorrelationId:
          $ref: "./common/headers.yaml#/components/parameters/correlationId"

    400:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: './schemas/error-response.yaml'
          examples:
            FORMAT_NINO:
              $ref: "./common/errors.yaml#/components/examples/formatNino"
            FORMAT_FROM_DATE:
              $ref: "./common/errors.yaml#/components/examples/formatFromDate"
            FORMAT_TO_DATE:
              $ref: "./common/errors.yaml#/components/examples/formatToDate"
            RANGE_TO_DATE_BEFORE_FROM_DATE:
              $ref: "./common/errors.yaml#/components/examples/rangeToDateBeforeFromDate"
            INVALID_DATE_RANGE:
              $ref: "./common/errors.yaml#/components/examples/invalidDateRange"
            MISSING_TO_DATE:
              $ref: "./common/errors.yaml#/components/examples/missingToDate"
            MISSING_FROM_DATE:
              $ref: "./common/errors.yaml#/components/examples/missingFromDate"
            RULE_INCONSISTENT_QUERY_PARAMS_LIST_SA:
              $ref: "./common/errors.yaml#/components/examples/ruleInconsistentQueryParamsListSA"
            FORMAT_PAYMENT_LOT:
              $ref: "./common/errors.yaml#/components/examples/formatPaymentLot"
            FORMAT_PAYMENT_LOT_ITEM:
              $ref: "./common/errors.yaml#/components/examples/formatPaymentLotItem"
            MISSING_PAYMENT_LOT:
              $ref: "./common/errors.yaml#/components/examples/missingPaymentLot"
            MISSING_PAYMENT_LOT_ITEM:
              $ref: "./common/errors.yaml#/components/examples/missingPaymentLotItem"

    403:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: './schemas/error-response.yaml'
          examples:
            CLIENT_OR_AGENT_NOT_AUTHORISED:
              $ref: "./common/errors.yaml#/components/examples/clientOrAgentNotAuthorised"

    404:
      description: Not found
      content:
        application/json:
          schema:
            $ref: './schemas/error-response.yaml'
          examples:
            NOT_FOUND:
              $ref: "./common/errors.yaml#/components/examples/notFound"
